# precisely-sfquickstart

**Steps for preparing data:**

--Preview some sample records from boundary table

select * from MBI__PREMIUM_GEOSPATIAL__MARKET_DATA.PROMOTIONAL."mbi_jp_cho_cho_moku_sample_region" limit 10;

--Preview some sample records from mbi market data

select * from MBI__PREMIUM_GEOSPATIAL__MARKET_DATA.PROMOTIONAL."mbi_marketdata_jp_cho_cho_moku_sample" limit 10;

--Preview some sample records from the table which is the result of joining the the market data and region data of MBI

select * from MBI__PREMIUM_GEOSPATIAL__MARKET_DATA.PROMOTIONAL."mbi_demographics_jp" limit 10;

--Preview some sample records from poi data which has is the result of extracting the poi data for the MBI region

select * from MBI__PREMIUM_GEOSPATIAL__MARKET_DATA.PROMOTIONAL."poi_jp" limit 10;

--create a new table by joining the boundary and market data using join on MICROCODE

create table "mbi_demographics_jp" as
select rgn.WKT, rgn.CTRYCODE, rgn.MICROCODE, rgn.NAME, rgn.GEOM,
mrktdata.P_T, mrktdata.P_PRM, mrktdata.HH_T, mrktdata.HH_SIZE, mrktdata.HH_I1, mrktdata.HH_I2, mrktdata.HH_I3, mrktdata.HH_I4, mrktdata.HH_I5, mrktdata.HHT_1, mrktdata.--HHT_2, mrktdata.HHT_3, mrktdata.HHT_4, mrktdata.MALE, mrktdata.FEMALE, mrktdata.AGE_T0014, mrktdata.AGE_M0014, mrktdata.AGE_F0014, mrktdata.AGE_T1529, mrktdata.--AGE_M1529, mrktdata.AGE_F1529, mrktdata.AGE_T3044, mrktdata.AGE_M3044, mrktdata.AGE_F3044, mrktdata.AGE_T4559, mrktdata.AGE_M4559, mrktdata.AGE_F4559, mrktdata.--AGE_T60PL, mrktdata.AGE_M60PL, mrktdata.AGE_F60PL, mrktdata.EDU_1, mrktdata.EDU_2, mrktdata.EDU_3, mrktdata.EDU_4, mrktdata.EDU_5, mrktdata.EDU_6, mrktdata.EDU_7, --mrktdata.EDU_8, mrktdata.MA_1, mrktdata.MA_2, mrktdata.MA_3, mrktdata.MA_4, mrktdata.UNEMPL, mrktdata.PP_MIO, mrktdata.PP_PRM, mrktdata.PP_EURO, mrktdata.PP_CI, --mrktdata.CSP01_MIO, mrktdata.CSP01_PRM, mrktdata.CSP01_EURO, mrktdata.CSP01_CI, mrktdata.CSP02_MIO, mrktdata.CSP02_PRM, mrktdata.CSP02_EURO, mrktdata.CSP02_CI, mrktdata.--CSP03_MIO, mrktdata.CSP03_PRM, mrktdata.CSP03_EURO, mrktdata.CSP03_CI, mrktdata.CSP04_MIO, mrktdata.CSP04_PRM, mrktdata.CSP04_EURO, mrktdata.CSP04_CI, mrktdata.--CSP05_MIO, mrktdata.CSP05_PRM, mrktdata.CSP05_EURO, mrktdata.CSP05_CI, mrktdata.CSP06_MIO, mrktdata.CSP06_PRM, mrktdata.CSP06_EURO, mrktdata.CSP06_CI, mrktdata.--CSP07_MIO, mrktdata.CSP07_PRM, mrktdata.CSP07_EURO, mrktdata.CSP07_CI, mrktdata.CSP08_MIO, mrktdata.CSP08_PRM, mrktdata.CSP08_EURO, mrktdata.CSP08_CI, mrktdata.--CSP09_MIO, mrktdata.CSP09_PRM, mrktdata.CSP09_EURO, mrktdata.CSP09_CI, mrktdata.CSP10_MIO, mrktdata.CSP10_PRM, mrktdata.CSP10_EURO, mrktdata.CSP10_CI, mrktdata.--CSP11_MIO, mrktdata.CSP11_PRM, mrktdata.CSP11_EURO, mrktdata.CSP11_CI, mrktdata.CSP12_MIO, mrktdata.CSP12_PRM, mrktdata.CSP12_EURO, mrktdata.CSP12_CI, mrktdata.--CSP13_MIO, mrktdata.CSP13_PRM, mrktdata.CSP13_EURO, mrktdata.CSP13_CI, mrktdata.CSP14_MIO, mrktdata.CSP14_PRM, mrktdata.CSP14_EURO, mrktdata.CSP14_CI, mrktdata.--CSP15_MIO, mrktdata.CSP15_PRM, mrktdata.CSP15_EURO, mrktdata.CSP15_CI, mrktdata.CSP16_MIO, mrktdata.CSP16_PRM, mrktdata.CSP16_EURO, mrktdata.CSP16_CI, mrktdata.--CSP17_MIO, mrktdata.CSP17_PRM, mrktdata.CSP17_EURO, mrktdata.CSP17_CI, mrktdata.CSP18_MIO, mrktdata.CSP18_PRM, mrktdata.CSP18_EURO, mrktdata.CSP18_CI, mrktdata.--CSP19_MIO, mrktdata.CSP19_PRM, mrktdata.CSP19_EURO, mrktdata.CSP19_CI, mrktdata.CSP20_MIO, mrktdata.CSP20_PRM, mrktdata.CSP20_EURO, mrktdata.CSP20_CI, mrktdata.P_T_TRE, --mrktdata.HH_T_TRE, mrktdata.MALE_TRE, mrktdata.FEMALE_TRE, mrktdata.T0014_TRE, mrktdata.M0014_TRE, mrktdata.F0014_TRE, mrktdata.T1529_TRE, mrktdata.M1529_TRE, mrktdata.--F1529_TRE, mrktdata.T3044_TRE, mrktdata.M3044_TRE, mrktdata.F3044_TRE, mrktdata.T4559_TRE, mrktdata.M4559_TRE, mrktdata.F4559_TRE, mrktdata.T60PL_TRE, mrktdata.--M60PL_TRE, mrktdata.F60PL_TRE, mrktdata.ALO_T_TRE, mrktdata.PP_CI_TRE, mrktdata.CSP01_TRE, mrktdata.CSP02_TRE, mrktdata.CSP03_TRE, mrktdata.CSP04_TRE, mrktdata.--CSP05_TRE, mrktdata.CSP06_TRE, mrktdata.CSP07_TRE, mrktdata.CSP08_TRE, mrktdata.CSP09_TRE, mrktdata.CSP10_TRE, mrktdata.CSP11_TRE, mrktdata.CSP12_TRE, mrktdata.--CSP13_TRE, mrktdata.CSP14_TRE, mrktdata.CSP15_TRE, mrktdata.CSP16_TRE, mrktdata.CSP17_TRE, mrktdata.CSP18_TRE, mrktdata.CSP19_TRE, mrktdata.CSP20_TRE
from
MBI__PREMIUM_GEOSPATIAL__MARKET_DATA.PROMOTIONAL."mbi_jp_cho_cho_moku_sample_region" rgn join MBI__PREMIUM_GEOSPATIAL__MARKET_DATA.PROMOTIONAL.--"mbi_marketdata_jp_cho_cho_moku_sample" mrktdata
on(rgn.MICROCODE = mrktdata.MICROCODE);

Set SRID for compatibility on spatial operations on both the table.
UPDATE "mbi_demographics_jp"
SET GEOM = ST_SetSRID(TRY_TO_GEOMETRY(WKT), 4326);

use the ST_Contains spatial function for getting all the points of interest data for this region and storing the results in a new table

create table SAMPLES_DB.PROMOTIONAL."poi_jp" as
SELECT      region.WKT,region.CTRYCODE,region.MICROCODE,region.NAME,region.P_T,region.P_PRM,region.HH_T,region.HH_SIZE,region.HH_I1,region.HH_I2,region.HH_I3,region.HH_I4,region.HH_I5,region.HHT_1,region.HHT_2,region.HHT_3,region.HHT_4,region.MALE,region.FEMALE,region.AGE_T0014,region.AGE_M0014,region.AGE_F0014,region.AGE_T1529,region.AGE_M1529,region.AGE_F1529,region.AGE_T3044,region.AGE_M3044,region.AGE_F3044,region.AGE_T4559,region.AGE_M4559,region.AGE_F4559,region.AGE_T60PL,region.AGE_M60PL,region.AGE_F60PL,region.EDU_1,region.EDU_2,region.EDU_3,region.EDU_4,region.EDU_5,region.EDU_6,region.EDU_7,region.EDU_8,region.MA_1,region.MA_2,region.MA_3,region.MA_4,region.UNEMPL,region.PP_MIO,region.PP_PRM,region.PP_EURO,region.PP_CI,region.CSP01_MIO,region.CSP01_PRM,region.CSP01_EURO,region.CSP01_CI,region.CSP02_MIO,region.CSP02_PRM,region.CSP02_EURO,region.CSP02_CI,region.CSP03_MIO,region.CSP03_PRM,region.CSP03_EURO,region.CSP03_CI,region.CSP04_MIO,region.CSP04_PRM,region.CSP04_EURO,region.CSP04_CI,region.CSP05_MIO,region.CSP05_PRM,region.CSP05_EURO,region.CSP05_CI,region.CSP06_MIO,region.CSP06_PRM,region.CSP06_EURO,region.CSP06_CI,region.CSP07_MIO,region.CSP07_PRM,region.CSP07_EURO,region.CSP07_CI,region.CSP08_MIO,region.CSP08_PRM,region.CSP08_EURO,region.CSP08_CI,region.CSP09_MIO,region.CSP09_PRM,region.CSP09_EURO,region.CSP09_CI,region.CSP10_MIO,region.CSP10_PRM,region.CSP10_EURO,region.CSP10_CI,region.CSP11_MIO,region.CSP11_PRM,region.CSP11_EURO,region.CSP11_CI,region.CSP12_MIO,region.CSP12_PRM,region.CSP12_EURO,region.CSP12_CI,region.CSP13_MIO,region.CSP13_PRM,region.CSP13_EURO,region.CSP13_CI,region.CSP14_MIO,region.CSP14_PRM,region.CSP14_EURO,region.CSP14_CI,region.CSP15_MIO,region.CSP15_PRM,region.CSP15_EURO,region.CSP15_CI,region.CSP16_MIO,region.CSP16_PRM,region.CSP16_EURO,region.CSP16_CI,region.CSP17_MIO,region.CSP17_PRM,region.CSP17_EURO,region.CSP17_CI,region.CSP18_MIO,region.CSP18_PRM,region.CSP18_EURO,region.CSP18_CI,region.CSP19_MIO,region.CSP19_PRM,region.CSP19_EURO,region.CSP19_CI,region.CSP20_MIO,region.CSP20_PRM,region.CSP20_EURO,region.CSP20_CI,region.P_T_TRE,region.HH_T_TRE,region.MALE_TRE,region.FEMALE_TRE,region.T0014_TRE,region.M0014_TRE,region.F0014_TRE,region.T1529_TRE,region.M1529_TRE,region.F1529_TRE,region.T3044_TRE,region.M3044_TRE,region.F3044_TRE,region.T4559_TRE,region.M4559_TRE,region.F4559_TRE,region.T60PL_TRE,region.M60PL_TRE,region.F60PL_TRE,region.ALO_T_TRE,region.PP_CI_TRE,region.CSP01_TRE,region.CSP02_TRE,region.CSP03_TRE,region.CSP04_TRE,region.CSP05_TRE,region.CSP06_TRE,region.CSP07_TRE,region.CSP08_TRE,region.CSP09_TRE,region.CSP10_TRE,region.CSP11_TRE,region.CSP12_TRE,region.CSP13_TRE,region.CSP14_TRE,region.CSP15_TRE,region.CSP16_TRE,region.CSP17_TRE,region.CSP18_TRE,region.CSP19_TRE,region.CSP20_TRE,poi.PB_ID,poi.POIID,poi.PBKEY,poi.PARENT,poi.NAME_2,poi.BRANDNAME,poi.TRADE_NAME,poi.FRANCHISE_,poi.ISO3,poi.AREANAME4,poi.AREANAME3,poi.AREANAME2,poi.AREANAME1,poi.STABB,poi.ADD_NUMBER,poi.STREETNAME,poi.POSTCODE,poi.FORMATTED_,poi.MAIN_ADDRE,poi.ADDRESS_LA,poi.SOURCE_ADD,poi.LONGITUDE,poi.LATITUDE,poi.GEORESULT,poi.GEO_CONFID,poi.COUNTRY_AC,poi.TEL_NUM,poi.FAXNUM,poi.EMAIL,poi.HTTP,poi.OPEN_24H,poi.BUSINESS_L,poi.SIC1,poi.SIC2,poi.SIC8,poi.SIC8_DESCR,poi.ALT_INDUST,poi.MICODE,poi.TRADE_DIVI,poi.GROUP_NAME,poi.MAIN_CLASS,poi.SUB_CLASS,poi.CEO_NAME,poi.CEO_TITLE,poi.EMPLOYEE_H,poi.EMPLOYEE_C,poi.YEAR_START,poi.NATL_ID_TY,poi.NATL_ID_VA,poi.SALES_VOLU,poi.SALES_VO00,poi.CURRENCY_C,poi.AGENT_CODE,poi.LEGAL_STAT,poi.STATUS_COD,poi.SUBSIDIARY,poi.PARENT_POI,poi.PARENT_BUS,poi.PARENT_ADD,poi.PARENT_STR,poi.PARENT_ARE,poi.PARENT_A00,poi.PARENT_COU,poi.PARENT_POS,poi.DOMESTIC_U,poi.DOMESTIC00,poi.DOMESTIC01,poi.DOMESTIC02,poi.DOMESTIC03,poi.DOMESTIC04,poi.DOMESTIC05,poi.GLOBAL_ULT,poi.GLOBAL_U00,poi.GLOBAL_U01,poi.GLOBAL_U02,poi.GLOBAL_U03,poi.GLOBAL_U04,poi.GLOBAL_U05,poi.GLOBAL_U06,poi.GLOBAL_U07,poi.FAMILY_MEM,poi.HIERARCHY_,poi.TICKER_SYM,poi.EXCHANGE_N,poi.GEOM
FROM "mbi_demographics_jp" region
JOIN "poi_jp_cho_cho_moku" poi 
ON ST_Contains(region.GEOM, poi.GEOM);
